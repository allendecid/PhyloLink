PhyloDisplay=function(a,b,c){function u(){var a=d3.select("#hiddin");"hidden"==a.style("visibility")?a.style("visibility",""):a.style("visibility","hidden")}function v(){var a=d3.select("#hiddin1");"hidden"==a.style("visibility")?a.style("visibility",""):a.style("visibility","hidden")}function H(){function e(){d3.text("./uploads/"+c,function(a){var b=require("fasta-parser"),c=a,d={},e=b(),g=0;e.on("data",function(a){d[g]=JSON.parse(a.toString()),g++}),e.write(c),e.end();var i=Object.keys(d).length,j=[],l=h.length;for(console.log(h.length),f=0;l>f;f++)for(k=0;i>k;k++)d[k].id===h[f]&&(j[f]=">"+d[k].id+"\n"+d[k].seq+"\n");var m=new Blob(j,{type:"text/plain;charset=utf-8"});saveAs(m,"sequence.txt")})}function g(){d3.text("./uploads/"+c,function(a){function y(){var a=d3.select("#barra").append("svg").attr("width",18*j).attr("height",30),b=d3.scale.linear().domain([1,j]).range([0,18*j]),c=d3.svg.axis().scale(b).orient("bottom").ticks(j-1);a.append("g").attr("transform","translate(8,1)").call(c)}var b=require("fasta-parser"),c=a,e={},g=b(),i=0;g.on("data",function(a){e[i]=JSON.parse(a.toString()),i++}),g.write(c),g.end();var j=e[0].seq.length,l=Object.keys(e).length,n=[],o={},p=h.length;for(console.log(h.length),f=0;p>f;f++)for(k=0;l>k;k++)if(e[k].id===h[f]){for(m=0;j>m;m++)o[m]=e[k].seq.charAt(m);n[f]=JSON.stringify(o)}for(console.log(n[0]),console.log(n[1]),f=0;p>f;f++)n[f]=jQuery.parseJSON(n[f]);d3.scale.category10();var s=[];for(f=0;p>f;f++)s[f]=$.map(n[f],function(a){return a});console.log(JSON.stringify(s));var t=d3.select("#alinea").append("table").append("tbody").selectAll("tr").data(s,function(a,b){return b>0?a:void 0}).enter().append("tr");t.selectAll("td").data(function(a){return a}).enter().append("td").style("background-color",function(a){return"A"===a?"red":"T"===a?"blue":"C"===a?"green":"G"===a?"yellow":"white"}).text(function(a){return a});var v=$(document).width();$(document).height(),d3.scale.ordinal().rangeRoundBands([0,v],.1),0===d&&(y(),d++)})}d3.csv("./uploads/"+b,function(b,c){function r(){d3.text("./uploads/"+a,function(a){function y(a,b,c){return a.replace(new RegExp(A(b),"g"),c)}function A(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function B(a){a.children?a.children.forEach(function(a){B(a)}):(t+=1,n+=a.branchlength)}function C(a){a.isSelected?d3.select(this).style("fill","lightsteelblue").attr("r","3.5"):d3.select(this).style("fill","#F94D00").attr("r","5.5")}function D(a){a.isSelected?d3.select(this).style("fill","#fff").attr("r","2.5"):d3.select(this).style("fill","#F94D00").attr("r","5.5")}function E(a,b){var c=function(a,b){if(b(a),a.children)for(var d=a.children.length-1;d>=0;d--)c(a.children[d],b)};c(a[0],function(a){a.rootDist=(a.parent?a.parent.rootDist:0)+(a.branchlength||0)});var d=a.map(function(a){return a.rootDist}),e=d3.scale.linear().domain([0,d3.max(d)]).range([0,b]);return c(a[0],function(a){a.y=e(a.rootDist)}),e}function F(){var a={w:75,h:30,s:3,r:3},b=d3.select("#legend").append("svg:svg").attr("width",a.w).attr("height",d3.keys(e).length*(a.h+a.s)),c=b.selectAll("g").data(d3.entries(e)).enter().append("svg:g").attr("transform",function(b,c){return"translate(0,"+c*(a.h+a.s)+")"});c.append("svg:rect").attr("rx",a.r).attr("ry",a.r).attr("width",a.w).attr("height",a.h).style("fill",function(a){return a.value}),c.append("svg:text").attr("x",a.w/2).attr("y",a.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(a){return a.key}).on("click",function(){window.location.reload(!0)})}function G(){var a=100,b=100,c=b/2;d3.scale.category20c();var e=[{label:o[1],value:f,color:"#90c843"},{label:o[2],value:g,color:"#A80000"},{label:o[3],value:k,color:"#555555"},{label:"Rest",value:t-(f+g+k),color:"steelblue"}],h=d3.select("#chart").append("svg:svg").data([e]).attr("width",a).attr("height",b).append("svg:g").attr("transform","translate("+c+","+c+")"),i=d3.layout.pie().value(function(a){return a.value}),j=d3.svg.arc().outerRadius(c),l=h.selectAll("g.slice").data(i).enter().append("svg:g").attr("class","slice");l.append("svg:path").attr("fill",function(a,b){return e[b].color}).attr("d",function(a){return j(a)}),l.append("svg:text").attr("transform",function(a){return a.innerRadius=0,a.outerRadius=c,"translate("+j.centroid(a)+")"}).attr("text-anchor","middle").text(function(a,b){return 0!==e[b].value?e[b].value:void 0}),l.append("svg:text").attr("dy",function(){return-40}).style("fill","#000").attr("text-anchor","middle").text(function(a,b){return 0!==e[b].value?"Totals":void 0})}function H(){var a=100,b=100,c=b/2;d3.scale.category20c();var e=[{label:o[1],value:f-m,color:"#90c843"},{label:o[2],value:g-m,color:"#A80000"},{label:o[3],value:k-m,color:"#555555"},{label:"Intercept",value:m,color:"blue"}],h=d3.select("#chart1").append("svg:svg").data([e]).attr("width",a).attr("height",b).append("svg:g").attr("transform","translate("+c+","+c+")"),i=d3.layout.pie().value(function(a){return a.value}),j=d3.svg.arc().outerRadius(c),l=h.selectAll("g.slice").data(i).enter().append("svg:g").attr("class","slice");l.append("svg:path").attr("fill",function(a,b){return e[b].color}).attr("d",function(a){return j(a)}),l.append("svg:text").attr("transform",function(a){return a.innerRadius=0,a.outerRadius=c,"translate("+j.centroid(a)+")"}).attr("text-anchor","middle").text(function(a,b){return 0!==e[b].value?e[b].value:void 0}),l.append("svg:text").attr("dy",function(){return-40}).style("fill","#000").attr("text-anchor","middle").text(function(a,b){return 0!==e[b].value?"Intercept":void 0})}if(1===l&&(e={"":"Transparent"},e[o[l]]="#90c843"),2===l&&(1===q&&(e={"":"Transparent"},e[o[l-1]]="#90c843",e[o[l]]="#A80000",q=0),e[o[l]]={},e[o[l]]="#A80000"),3===l&&(1===q&&(e={"":"Transparent"},e[o[l-2]]="#90c843",e[o[l-1]]="#A80000",e[o[l]]="#555555",q=0),e[o[l]]={},e[o[l]]="#555555"),d3.select("#legend").selectAll("svg").remove(),F(),console.log(t),null===p)var b=a,c=y(b," ",""),d=nwk.parser.parse(c),i=nwk.converter.toBinary(d),u=nwk.converter.toJSON(i),v=y(u,',"children":[]',""),x=JSON.parse(v);else x=p,p=null;t=0,B(x),Phylodiag=function(){function c(c){var e=c.source,f=c.target,i=((e.x+f.x)/2,(e.y+f.y)/2,[e,{x:f.x,y:e.y},f]);return i=i.map(a),b(i)}var a=function(a){return[a.y,a.x]},b=function(a){return"M"+a[0]+" "+a[1]+" "+a[2]};return c.projection=function(b){return arguments.length?(a=b,c):a},c.path=function(a){return arguments.length?(b=a,c):b},c},PhyloAngle=function(a,b){var c=2*Math.PI,d=c/4,e=a[0]>=0?a[1]>=0?1:2:a[1]>=0?4:3,f=Math.abs(Math.asin(a[1]/b));switch(e){case 1:coordAngle=d-f;break;case 2:coordAngle=d+f;break;case 3:coordAngle=2*d+d-f;break;case 4:coordAngle=3*d+f}return coordAngle},PhyloNodes=function(a){a.selectAll("g.leaf.node").append("svg:circle").attr("r","3.5").attr("fill","lightsteelblue").attr("stroke","steelblue").attr("stroke-width","2px").on("click",C),a.selectAll("g.inner.node").append("svg:circle").attr("r","2.5").attr("fill","#fff").attr("stroke","steelblue").attr("stroke-width","2px").on("click",D),a.selectAll("g.root.node").append("svg:circle").attr("r",4.5).attr("fill","steelblue").attr("stroke","#369").attr("stroke-width","2px")},phylodraw=function(a){function r(){q.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),q.selectAll("rect").attr("width",5/i.scale()).attr("height",5/i.scale()),q.selectAll("ellipse").attr("rx",2/i.scale()).attr("ry",4/i.scale()),q.selectAll("line").attr("y1",-3/i.scale()).attr("y2",3/i.scale()).attr("stroke-width",5/i.scale()),q.selectAll("path.link").attr("stroke-width",1.5/i.scale())}function A(a){a.children?a.children.forEach(A):(h[j]=a.name,j++)}function B(a){if(a.children)a.children.forEach(B);else{var b=h.indexOf(a.name);h.splice(b,1),j--}}var b=$(window).height();11*t>$(window).height()&&(b=11*t);var c=$(window).width(),d=b,e=d3.layout.cluster().size([d,c]).sort(function(a){return a.children?a.children.length:-1}).children(function(a){return a.children}),a=e(a);a.forEach(function(a){if(!a.children&&(s[a.name]="",!a._children))for(J=1;J<w.length;J++)"undefined"!=typeof z[a.name][J]&&(s[a.name]+=w[J]+" : "+z[a.name][J]+"<br/>")});var i=d3.behavior.zoom().scaleExtent([.1,3]).on("zoom",r),n=Phylodiag(),q=d3.select("#tree-container").append("svg:svg").attr("width",c+300).attr("height",d+50).attr("class","overlay").call(i).append("svg:g").attr("transform","translate(20, 20)");E(a,c),q.selectAll("path.link").data(e.links(a)).enter().append("svg:path").attr("class","link").attr("d",n).attr("fill","none").attr("stroke","#383838").attr("stroke-width","1.5px");var y=q.selectAll("g.node").data(a).enter().append("svg:g").attr("class",function(a){return a.children?0==a.depth?"root node":"inner node":"leaf node"}).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}).on("click",function(a){a.isSelected?a.children?a.children&&B(a):(h.splice(a.isSelected,1),j--,console.log(h.length),delete a.isSelected):(a.isSelected=j,d3.select("#alinea").selectAll("tr").remove(),a.children?a.children&&(p=a,A(a)):(h[j]=a.name,j++))}).on("mouseover",function(a){a.children||(C.transition().duration(200).style("opacity",.9),C.html(s[a.name]).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px"))}).on("mouseout",function(){C.transition().duration(500).style("opacity",0)});y.append("rect").attr("class","nodeRect").attr("x",-10).attr("y",-3.5).attr("width",3).attr("height",7).style("fill",function(a){if(0===l||a.children)return"transparent";for(J=1;J<w.length;J++)if("undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[1])return f+=1,"#90c843"}),y.append("ellipse").attr("class","nodeEllipse").attr("cx",-15).attr("cy",0).attr("rx",2).attr("ry",4).style("fill",function(a){if(2!==l&&3!==l||a.children)return"transparent";for(J=1;J<w.length;J++)if("undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[2])return g+=1,"undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[1]&&(m+=1),"#A80000"}),y.append("line").attr("x1",-23).attr("y1",-3).attr("x2",-20).attr("y2",3).attr("stroke-width",2).style("stroke",function(a){if(3!==l||a.children)return"transparent";for(J=1;J<w.length;J++)if("undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[3])return k+=1,"undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[2]&&"undefined"!=typeof z[a.name][J]&&z[a.name][J]===o[1]&&(m+=1),"#555555"});var C=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);return PhyloNodes(q),q.selectAll("g.inner.node").append("svg:text").attr("dx",-6).attr("dy",-6).attr("text-anchor","end").attr("font-size","5").attr("fill","#606060 ").text(function(a){return a.name}),q.selectAll("g.leaf.node").append("svg:text").attr("dx",8).attr("dy",3).attr("text-anchor","start").attr("font-size","7").attr("fill","#383838").text(function(a){return a.name}),{tree:e,vis:q}},phylodraw(x);var b={};b.d=[{FirstName:"Sequences",Age:t},{FirstName:"Avg Distance",Age:(n/t).toFixed(4)},{FirstName:"Total Distance",Age:n.toFixed(4)}],$("#thetable tr").not(":first").not(":last").remove();for(var I="",J=0;J<b.d.length;J++)I+="<tr><td>"+b.d[J].FirstName+"</td><td>"+b.d[J].Age+"</td></tr>";$("#thetable tr").first().after(I),0!==l&&(d3.select("#chart").selectAll("svg").remove(),d3.select("#chart1").selectAll("svg").remove(),G(),H()),$(".qtymake").click(function(){d3.select("#tree-container").selectAll("svg").remove(),r()}),$(".qtyunmake").click(function(){d3.select("#tree-container").selectAll("svg").remove(),h=[],j=0,l=0,o=[],p=null,e={"":"Transparent"},f=0,g=0,k=0,t=0,m=0,n=0,d3.select("#chart").selectAll("svg").remove(),d3.select("#chart1").selectAll("svg").remove(),r()})})}function u(){d3.text("./uploads/"+a,function(a){function r(a,b,c){return a.replace(new RegExp(u(b),"g"),c)}function u(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function v(a,b){var c=function(a,b){if(b(a),a.children)for(var d=a.children.length-1;d>=0;d--)c(a.children[d],b)};c(a[0],function(a){a.rootDist=(a.parent?a.parent.rootDist:0)+(a.branchlength||0)});var d=a.map(function(a){return a.rootDist}),e=d3.scale.linear().domain([0,d3.max(d)]).range([0,b]);return c(a[0],function(a){a.y=e(a.rootDist)}),e}function x(){var a={w:75,h:30,s:3,r:3},b=d3.select("#legend").append("svg:svg").attr("width",a.w).attr("height",d3.keys(e).length*(a.h+a.s)),c=b.selectAll("g").data(d3.entries(e)).enter().append("svg:g").attr("transform",function(b,c){return"translate(0,"+c*(a.h+a.s)+")"});c.append("svg:rect").attr("rx",a.r).attr("ry",a.r).attr("width",a.w).attr("height",a.h).style("fill",function(a){return a.value}),c.append("svg:text").attr("x",a.w/2).attr("y",a.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(a){return a.key}).on("click",function(){window.location.reload(!0)})}var b=a,c=r(b," ",""),d=nwk.parser.parse(c),h=nwk.converter.toBinary(d),j=nwk.converter.toJSON(h),n=r(j,',"children":[]',""),p=JSON.parse(n);1===l&&(e={"":"Transparent"},e[o[l]]="#90c843"),2===l&&(1===q&&(e={"":"Transparent"},e[o[l-1]]="#90c843",e[o[l]]="#A80000",q=0),e[o[l]]={},e[o[l]]="#A80000"),3===l&&(1===q&&(e={"":"Transparent"},e[o[l-2]]="#90c843",e[o[l-1]]="#A80000",e[o[l]]="#555555",q=0),e[o[l]]={},e[o[l]]="#555555"),console.log(JSON.stringify(e)),d3.select("#legend").selectAll("svg").remove(),x(),phylogram1={},Phylodiag=function(){function c(c){var e=c.source,f=c.target,i=((e.x+f.x)/2,(e.y+f.y)/2,[e,{x:f.x,y:e.y},f]);return i=i.map(a),b(i)}var a=function(a){return[a.y,a.x]},b=function(a){return"M"+a[0]+" "+a[1]+" "+a[2]};return c.projection=function(b){return arguments.length?(a=b,c):a},c.path=function(a){return arguments.length?(b=a,c):b},c},PhyloAngle=function(a,b){var c=2*Math.PI,d=c/4,e=a[0]>=0?a[1]>=0?1:2:a[1]>=0?4:3,f=Math.abs(Math.asin(a[1]/b));switch(e){case 1:coordAngle=d-f;break;case 2:coordAngle=d+f;break;case 3:coordAngle=2*d+d-f;break;case 4:coordAngle=3*d+f}return coordAngle},PhyloNodes=function(a){a.selectAll("g.leaf.node").append("svg:circle"),a.selectAll("g.root.node").append("svg:circle").attr("r",4.5).attr("fill","steelblue").attr("stroke","#369").attr("stroke-width","2px")},phylodraw=function(a){function p(){n.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),n.selectAll("rect").attr("width",5/h.scale()).attr("height",5/h.scale()),n.selectAll("ellipse").attr("rx",2/h.scale()).attr("ry",4/h.scale()),n.selectAll("line").attr("y1",-3/h.scale()).attr("y2",3/h.scale()).attr("stroke-width",5/h.scale()),n.selectAll("path.link").attr("stroke-width",1.5/h.scale())}var b=$(document).height();8*t>$(document).height()&&(b=8*t);var c=$(document).width(),d=b,e=d3.layout.cluster().size([d,c]).sort(function(a){return a.children?a.children.length:-1}).children(function(a){return a.children}),h=d3.behavior.zoom().scaleExtent([.1,3]).on("zoom",p),j=Phylodiag(),n=d3.select("#tree-container").append("svg:svg").attr("width",c+300).attr("height",d+50).attr("class","overlay").call(h).append("svg:g").attr("transform","translate(20, 20)"),a=e(a);v(a,c),n.selectAll("path.link").data(e.links(a)).enter().append("svg:path").attr("class","link").attr("d",j).attr("fill","none").attr("stroke","#383838").attr("stroke-width","1.5px");var x=n.selectAll("g.node").data(a).enter().append("svg:g").attr("class",function(a){return a.children?0==a.depth?"root node":"inner node":"leaf node"}).attr("transform",function(a){return"translate("+a.y+","+a.x+")"}).on("mouseover",function(a){a.children||(y.transition().duration(200).style("opacity",.9),y.html(s[a.name]).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px"))}).on("mouseout",function(){y.transition().duration(500).style("opacity",0)});x.append("rect").attr("class","nodeRect").attr("x",-10).attr("y",-3.5).attr("width",3).attr("height",7).style("fill",function(a){if(0===l||a.children)return"transparent";for(i=1;i<w.length;i++)if("undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[1])return f+=1,"#90c843"}),x.append("ellipse").attr("class","nodeEllipse").attr("cx",-15).attr("cy",0).attr("rx",2).attr("ry",4).style("fill",function(a){if(2!==l&&3!==l||a.children)return"transparent";for(i=1;i<w.length;i++)if("undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[2])return g+=1,"undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[1]&&(m+=1),"#A80000"}),x.append("line").attr("x1",-23).attr("y1",-3).attr("x2",-20).attr("y2",3).attr("stroke-width",2).style("stroke",function(a){if(3!==l||a.children)return"transparent";for(i=1;i<w.length;i++)if("undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[3])return k+=1,"undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[2]&&"undefined"!=typeof z[a.name][i]&&z[a.name][i]===o[1]&&(m+=1),"#555555"});var y=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);return PhyloNodes(n),n.selectAll("g.inner.node").append("svg:text").attr("dx",-6).attr("dy",-6).attr("text-anchor","end").attr("font-size","5").attr("fill","#606060 ").text(function(a){return a.name}),n.selectAll("g.leaf.node").append("svg:text").attr("dx",8).attr("dy",3).attr("text-anchor","start").attr("font-size","7").attr("fill","#383838").text(function(a){return a.name}),{tree:e,vis:n}},phylodraw(p)})}function v(a,b){var c=d3.select("#tabla").append("table").attr("id","hor-minimalist-b"),d=c.append("thead"),f=c.append("tbody");d.append("tr").selectAll("th").data(b).enter().append("th").append("h3").text(function(a){return a});var g=f.selectAll("tr").data(a).enter().append("tr");return g.selectAll("td").data(function(a){return b.map(function(b){return{column:b,value:a[b]}})}).enter().append("td").html(function(a){return a.value}).on("click",function(a){d3.select("#tree-container").selectAll("svg").remove(),3===l?(l=1,o=[],r(),o[l]=a.value,e={"":"Transparent"}):(r(),l++,o[l]=a.value)}),c}function x(){var a=d3.select("#tabla");"hidden"===a.style("visibility")?(a.style("visibility",""),v(c,w)):(d3.select("#tabla").selectAll("tr").remove(),a.style("visibility","hidden"))}c.forEach(function(a){for(z[a[w[0]]]=[],i=1;i<w.length;i++)"undefined"!=typeof w[i]&&(z[a[w[0]]][i]=a[w[i]]);a.close=+a.close});var e={"":"Transparent"},f=0,g=0,k=0;t=0;var m=0,n=0;d3.selectAll("input").on("change",function(){var a=this.value;"Phyloviz"===a?(d3.select("#tree-container").selectAll("svg").remove(),r()):"Dendogram"===a&&(d3.select("#tree-container").selectAll("svg").remove(),u())}),r(),d3.select("#openert").on("click",x),$(document).ready(function(){$("#btnSubmit").click(function(){var a=$("#frm1 :input");o=[],l=0,q=1,a.each(function(){$(this).val()&&"Search"!==$(this).val()&&(l++,o[l]=$(this).val(),console.log(l),console.log($(this).val()))}),d3.select("#tree-container").selectAll("svg").remove(),r()})})}),$("#dialog").dialog({autoOpen:!1,resizable:!0,show:"slide",modal:!0,buttons:{"Save as Fasta":function(){e()},Visualize:function(){g()}}}),$("#opener").click(function(){d3.select("#dialog").selectAll("td").remove(),$("#dialog").dialog("open"),$("#dialog").dialog("option","position",{my:"left center",at:"left center"})})}function I(){var a=document.createElement("script");"https:"===window.location.protocol?a.setAttribute("src","https://rawgit.com/NYTimes/svg-crowbar/gh-pages/svg-crowbar.js"):a.setAttribute("src","http://nytimes.github.com/svg-crowbar/svg-crowbar.js"),a.setAttribute("class","svg-crowbar"),document.body.appendChild(a)}var n,t,d=0,h=[],j=0,l=0,o=[],p=null,q=0,s=[];d3.select("#toggler").on("click",u),d3.csv("./uploads/"+b,function(a){n=Object.keys(a[0]),select=document.getElementById("countries"),select1=document.getElementById("countries1"),select2=document.getElementById("countries2"),select3=document.getElementById("countries3"),select4=document.getElementById("countries4"),select5=document.getElementById("countries5"),select6=document.getElementById("countries6"),select7=document.getElementById("countries7"),select8=document.getElementById("countries8");for(key in n)select.add(new Option(n[key])),select1.add(new Option(n[key])),select2.add(new Option(n[key])),select3.add(new Option(n[key])),select4.add(new Option(n[key])),select5.add(new Option(n[key])),select6.add(new Option(n[key])),select7.add(new Option(n[key])),select8.add(new Option(n[key]));v()});var w=[];$(document).ready(function(){$("#btnSubmit1").click(function(){var a=$("#frm2 select");ci=0,a.each(function(){$(this).val()&&"Start"!==$(this).val()&&"3"!==$(this).val()&&(w[ci]=$(this).val(),ci++)}),H(),v()})});var z={};d3.select("#saveimage").on("click",I)};
